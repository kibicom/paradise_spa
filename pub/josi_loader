<!--
        imag3
        
        Copyright 2012 Жлобенцев Владимир <dnclive@gmail.com>
        
        Шаблон верхнего уровня интернет магазина imag3
        
-->

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//RU"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru">

<head>
	<title>[[f:struct_val^key:service_conf.title]]</title>
	<meta http-equiv="content-type" content="text/html;charset=utf-8" />
	<meta name="generator" content="Geany 0.20" />
	
	<!--стили-->
	
	<!--link rel="stylesheet" type="text/css" href="res/je_mod/paradise_spa/tpl/all.css"/-->
	<link rel="stylesheet" type="text/css" href="res/je_mod/form/tpl/css.css"/>
	<link rel="stylesheet" type="text/css" href="res/je_mod/form/tpl/waiter/waiter.css"/>
	<link rel="stylesheet" type="text/css" href="res/je_mod/paradise_spa/tpl/css.css"/>
	
	<!--link rel="stylesheet" type="text/css" href="res/tpl/css.css"/-->
	<!--link rel="stylesheet" type="text/css" href="res/tpl/aquaon/css.css"/-->
	
	<!--framework-->
	<!--link rel="stylesheet" type="text/css" href="../release/dijit/themes/claro/claro.css"-->
	<link rel="stylesheet" type="text/css" href="res/josi/js/jquery/release/css/ui-lightness/jquery-ui-1.8.18.custom.css"/>
	
	<!--javasctipt-->

	<!--google analistics-->	
	{{f:tpl^page_path:res/tpl/aquaon/google_analistics_code.tpl}}
	
	<!--yandex metric-->	
	{{f:tpl^page_path:res/tpl/aquaon/yandex_metric_code_.tpl}}
	
	<!--DoJo-->
	<script src="res/conf/dojo_config.js"></script>
	
	<!--продуктивный билд-->
	<!--script src="res/josi/js/dojo/release/dojo/dojo/dojo.js"></script>
	
	<!--отладочный-->
	<script src="res/josi/js/dojo/dev/dojo/dojo.js"></script>
	
	<!--jquery кеширование скриптов-->
	<script src="res/josi/js/jquery/release/jquery-1.7.2.min.js"></script>
	<!--script src="../jquery/js/jquery-ui-1.8.20.custom.min.js"></script>
	<script src="../jquery/development-bundle/ui/i18n/jquery.ui.datepicker-ru.js"></script-->
	
	
	<script src="res/je_mod/paradise_spa/js/sparkanim.js"></script>
	<script src="res/je_mod/paradise_spa/js/gallery.js"></script>
	<script src="res/je_mod/paradise_spa/js/app.js"></script>
	
	<!--загрузка галереи-->
	<script type="text/javascript">
		var galleries = 
		{

			'glamour': 
			[
		        {src: 'res/je_mod/paradise_spa/img/gallery/1c25967b68da8a3105465be73e3d7a52.jpg', title: "Гламур"}, 
		        {src: 'res/je_mod/paradise_spa/img/gallery/bcbe975d8506e91657b7d62b762852b1.jpg', title: "Гламур"},
		        {src: 'res/je_mod/paradise_spa/img/gallery/00eb78a1c961ea1c14f78e20e600ac9c.jpg', title: "Гламур"},
		        {src: 'res/je_mod/paradise_spa/img/gallery/34ba9fd9383390d7762d710b1d5574d4.jpg', title: "Гламур"},
		        {src: 'res/je_mod/paradise_spa/img/gallery/e5d3ee67be4defede668f64978afc05e.png', title: "Гламур"}        
			]
		}
		
		
	</script>

	
	<!--скрипт выполняющий запуск сервиса-->
	<script>
		require(
		//["tlib/tlib"],
		[],
		function(t_lib)
		{
			require(
			[	
				"tlib/tjosi",
				"tlib/tres",
			],
			function(t_josi, t_res)
			{
				
				//josi_conf.js
				{{f:tpl^tpl_path:res/conf/josi_conf.js}}

				//инициализация josi, запуск очереди задач
				t_josi.f_cre({config:config});

				//сохраняем service_conf из josi_conf.js в структуру локальных ресурсов
				t_res.f_struct_res_arr_set(
				{
					key:"service_conf",
					val:service_conf,
				})

				//излучение события load
				t_josi.f_ev_load_emit();
			
				//var je_mod={};
			
				//App.start();
			
				
			
				return;
			});
		});
	
	</script>

	<!--загрузка галереи-->
	<script type="text/javascript">
		
		var je_mod={};
		
		require(
		["tlib/tuti"],
		function(t_uti)
		{
			je_mod["paradise_spa"]=
			{
				args:
				{
					is_init:false,
				},
				
				f_mi_click_1:function(args)
				{
					
					$('.glow').addClass("hidden");
					
					//поднимаем меню вверх
					$('.mi_main').addClass("anim_mi_main_up");
					$('.mi_gallery').addClass("anim_mi_gallery_up");
					$('.mi_service_and_price').addClass("anim_mi_service_and_price_up");
					$('.mi_virtual_tour').addClass("anim_mi_virtual_tour_up");
					$('.mi_about').addClass("anim_mi_about_up");
					
					//плавно скрываем лого
					//$('.content_1').removeClass("main_logo_show_anim");
					$('.content_2').addClass("hidden");
					$('.main_logo').addClass("main_logo_hide_anim");
					$('.main_logo').bind("animationend webkitAnimationEnd", function() 
					{
						$('.blur_bg').addClass("main_logo_show_anim");
						$('.blur_bg').removeClass("hidden");
					});
						//$('.main_logo').addClass("hidden");
						if ($('.content_2').hasClass("hidden"))
						{
							$('.content_2').addClass("main_logo_show_anim");
							$('.content_2').removeClass("hidden");
							$('.content_2').bind("animationend webkitAnimationEnd", function() 
							{
								$('.main_logo').addClass("hidden");
								
							});
						}
						/*
						else
						{
							$('.content_2').addClass("main_logo_show_anim");
							$('.main_logo').bind("animationend webkitAnimationEnd", function() 
							{
								$('.content_2').addClass("main_logo_show_anim");
								$('.content_2').removeClass("hidden");
								$('.content_2').bind("animationend webkitAnimationEnd", function() 
								{
									$('.main_logo').addClass("hidden");
									
								});
							});
						}
						*/
					//});
					//скрываем фон и градиент
					//$('.main_logo').addClass('hidden');
					//$('.logo_img_back').addClass("hidden");
					//$('.logo_img_upper').addClass("hidden");
					//$('.glow').addClass("hidden");
					
					
					//уплывает фон
					//$('.logo_img_upper').addClass("logo_blur_2");
					
					//выключаем звездочки
					$('.spark').css({"display":"none"});
					
					//включаем header и footer
					//$('.content_1').css({"height":"70%"});
					$('.head').removeClass("hidden");
					$('.foot').removeClass("hidden");
					
					t_uti.f_fdone(args.fdone);
				},
				
				f_mi_main_click_1:function(args)
				{
					
					//выключаем header и footer
					$('.head').addClass("hidden");
					$('.foot').addClass("hidden");
					
					je_mod["paradise_spa"]["args"].f_main_logo_init();
			
					t_uti.f_fdone(args.fdone);
				},
				
				f_main_logo_init:function(args)
				{
					/*
					if (!je_mod["paradise_spa"]["args"]["is_init"])
					{
						je_mod["paradise_spa"]["args"]["is_init"]=true;
						
						//SparkAnim.init();
						
						//t_uti.f_fdone(args.fdone);
						//return;
					}
					*/
					
					//alert("123");
					
					var gradAnimationSeq=
						[
							{ '-webkit-animation-name': "grad1_trans", '-webkit-animation-duration': '3s', '-webkit-animation-delay': '1s',
							  '-moz-animation-name': "grad1_trans", '-moz-animation-duration': '3s', '-moz-animation-delay': '1s',
							  'animation-name': "grad1_trans", 'animation-duration': '3s', 'animation-delay': '1s'},
							{ '-webkit-animation-name': "grad2_trans", '-webkit-animation-duration': '10s', '-webkit-animation-delay': '0',
							  '-moz-animation-name': "grad2_trans", '-moz-animation-duration': '10s', '-moz-animation-delay': '0',
							  'animation-name': "grad2_trans", 'animation-duration': '10s', 'animation-delay': '0'}
						];
						var currGradAnimation=0;
					
						//alert("123");
					
						$('.gradient').bind("animationend webkitAnimationEnd", function() 
						{
							
							currGradAnimation++;
							if (currGradAnimation == gradAnimationSeq.length) 
							{
								currGradAnimation = 0;
							}
							//console.log(App.gradAnimationSeq[App.currGradAnimation]);
							//alert(currGradAnimation);
							
							$('.gradient').css(gradAnimationSeq[currGradAnimation]);
							//console.log("error", $('.gradient'), gradAnimationSeq, gradAnimationSeq[currGradAnimation]);
							
						}).css(gradAnimationSeq[0]);
					
					// currently applied transition
					
					//выключаем header и footer
					//$('.head').addClass("hidden");
					//$('.foot').addClass("hidden");
					$('.blur_bg').removeClass("main_logo_show_anim");
					$('.blur_bg').addClass("hidden");
					$('.main_logo').removeClass("main_logo_hide_anim");
					$('.main_blur_bg_stl').removeClass("hidden");
					$('.content_1').removeClass("hidden");
					$('.content_1').addClass("main_logo_show_anim");
					
					$('.content_1').bind("animationend webkitAnimationEnd", function() 
					{
					
						$('.head').addClass("hidden");
						
						//je_mod["paradise_spa"]["args"]["is_init"]=true;
						
						//$('.content_1').css({"height":"100%"});
						
						$('.glow').removeClass("hidden");
						
						
						
					
					
					
						//SparkAnim=spark_anim_bak;
						//SparkAnim.stop();
						SparkAnim.init();
						//alert(je_mod["paradise_spa"]["args"]["is_init"]);
						if (!je_mod["paradise_spa"]["args"]["is_init"])
						{
							je_mod["paradise_spa"]["args"]["is_init"]=true;
							
							//alert ("123");
							
							SparkAnim.play();
							
							//t_uti.f_fdone(args.fdone);
							//return;
						}
						
						//SparkAnim.play();
					
					})
					t_uti.f_fdone(args.fdone);
			
				},
			}
		});
		
	</script>

	<script src="res/zoomSlider/zoomSlider.js" type="text/javascript"></script>
    <link href="res/zoomSlider/themes/1/zoomslider.css" rel="stylesheet" type="text/css" />
	<!--script type="text/javascript">
        //The following script is for custom navigation buttons.
        function switchAutoAdvance() {
            zoomSlider.switchAuto();
            switchPlayPauseClass();
        }
        function switchPlayPauseClass() {
            var auto = document.getElementById('auto');
            if (auto) {
                var isAutoPlay = zoomSlider.getAuto();
                auto.className = isAutoPlay ? "navPause" : "navPlay";
                auto.title = isAutoPlay ? "Pause" : "Play";
            }
        }
        switchPlayPauseClass();


        //Change the captionEffect. It is recommended to set { captionEffect: "fade" } directly through the zoomSliderOptions in the javascript file instead of using the approach below
        zoomSlider.changeOptions({ captionEffect: "fade" });

    </script-->

</head>

<body 	class="body claro body_stl_smpl" 
		data-josi-kvl-str="
		f:waiter_show>
		
		<!--новый правильный лоадер выключен пока не реализован механизм 
		{{f:tpl^page_path:loader.scl&service:{{f:show_val^service&key:service}}&k:v}}-->

		{{f:tpl^page_path:loader.scl&service:res/je_mod/paradise_spa/tpl/main.tpl}}
		
		f:f
		^
		mod_name:paradise_spa&
		f_name:f_main_logo_init
		
		>

		f:waiter_hide"
		data-josi-ev-resp="load">
	
	<!--окно для вывода отладочной информации-->
	<textarea class="trans_resp hidden">
	
	</textarea>
	
	<!--основной контент страницы-->
	<div class="service_div content" style="height:100%">
		{{f:tpl^page_path:res/je_mod/paradise_spa/tpl/main.tpl}}
	</div>
	
	<!--какой то мусор-->
	<div class="hidden">
				<input 	class="josi_form_input_div_stl_smpl" type="text" name="date1" id="time1" value="T15:00:00"
					data-dojo-type_="dijit.form.TimeTextBox"
					onChange="dojo.byId('val').value=arguments[0].toString().replace(/.*1970\s(\S+).*/,'T$1')"
					required="true" />
	</div>
	
	
	{{f:tpl^tpl_path:res/je_mod/form/tpl/popup/form.tpl}}

	{{f:tpl^tpl_path:res/je_mod/paradise_spa/tpl/waiter.tpl}}
	
	{{f:tpl^tpl_path:res/je_mod/formtpl//city_selector/form.tpl}}
	
	{{f:tpl^tpl_path:res/je_mod/form/tpl/other_browser.tpl}}
</body>

</html>
